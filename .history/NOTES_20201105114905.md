https://github.com/NativeScript/nativescript-plugin-seed

# TODO

- set APP_ID on cast button xml?

- add types for options

- add button programatically?

- event response
  - obj.eventName instead of obj.data.eventName
  - test if doing already? update readme

# iOS

- removed `pod 'google-cast-sdk'` from Podfile
- added `GoogleCast.framework` static library to include exported constants

## Updating Cast SDK

### iOS

https://developers.google.com/cast/docs/ios_sender#manual_setup

Download: Dynamic with Guest Mode
Copy to src/platforms/ios

### Generate Typings

https://github.com/NativeScript/nativescript-plugin-seed#generating-typings-for-ios

```sh
cd demo/
TNS_TYPESCRIPT_DECLARATIONS_PATH="$(pwd)/typings" ns build ios
```

copy `demo/typings/x86_64/objc!GoogleCast.d.ts`
to `src/platforms/ios/typings`

### Android

Update latest versions in `src/platforms/android/include.gradle`.

### Generate Typings

https://github.com/NativeScript/nativescript-plugin-seed#generating-typings-for-android

Add updated versions from `include.gradle` to `android-dts-generator/dts-generator/build.gradle`

```sh
cd dts-generator
./gradlew extractAllJars
./gradlew jar
java -jar build/libs/dts-generator.jar -input jar-files/
```

copy `android-dts-generator/dts-generator/out/*`
to `src/platforms/android/typings`

---
e.g.

kGCKMetadataKeyTitle: com.google.cast.metadata.TITLE

Publishing your app to App Store (iOS)

Before publishing your app to the App Store, you need to run shell script `strip_unused_archs.sh` to strip unused architectures from the app bundle. This script is in the Cast SDK for iOS.

---

## Methods

playMedia
pauseMedia
seekMedia
stopMedia
getMediaInfo

getRemoteMediaClient

## Events

Events follow the Android naming structure. iOS events are passed from `GCKSessionManagerListener`. Android events are passed from both `SessionManagerListener` and `MediaRouter.Callback`.

| Nativescript          | Android               | iOS                    |
| --------------------- | --------------------- | ---------------------- |
| onSessionEnded        | onSessionEnded        | didEndSession          |
| onSessionEnding       | onSessionEnding       | willEndSession         |
| onSessionResumed      | onSessionResumed      | didResumeSession       |
| onSessionResuming     | onSessionResuming     | willResumeSession      |
| onSessionStarted      | onSessionStarted      | didStartSession        |
| onSessionStartFailed  | onSessionStartFailed  | didFailToStartSession  |
| onSessionStarting     | onSessionStarting     | willStartSession       |
| onSessionSuspended    | onSessionSuspended    | didSuspendSession      |

| onDeviceVolumeChanged | onRouteVolumeChanged  | didReceiveDeviceVolume |


| onDeviceChanged       | onRouteChanged        | didUpdateDevice        |

didReceiveDeviceStatus
didUpdateDevice


All unlisted events are ignored. See related documentation for futher details.

 - Android: [SessionManagerListener](https://developers.google.com/android/reference/com/google/android/gms/cast/framework/SessionManagerListener)
 - Android: [MediaRouter.Callback](https://developer.android.com/reference/android/support/v7/media/MediaRouter.Callback)
 - iOS: [GCKSessionManagerListener](https://developers.google.com/cast/v3/reference/ios/protocol_g_c_k_session_manager_listener-p)

## Depdency
lodash

## MetadataType
MEDIA_TYPE_GENERIC: "0"
MEDIA_TYPE_MOVIE: "1"
MEDIA_TYPE_TV_SHOW: "2"
MEDIA_TYPE_MUSIC_TRACK: "3"
MEDIA_TYPE_PHOTO: "4"
MEDIA_TYPE_USER: "100"

## StreamType

STREAM_TYPE_NONE: "0"
GCKMediaStreamTypeNone

STREAM_TYPE_BUFFERED: "1"
GCKMediaStreamTypeBuffered

STREAM_TYPE_LIVE: "2"
GCKMediaStreamTypeLive

---

## Media Queue

## Android

https://developers.google.com/android/reference/com/google/android/gms/cast/framework/media/MediaQueue
https://developers.google.com/android/reference/com/google/android/gms/cast/framework/media/MediaQueue.Callback

## iOS

https://developers.google.com/cast/docs/reference/ios/interface_g_c_k_media_queue
https://developers.google.com/cast/docs/reference/ios/protocol_g_c_k_media_queue_delegate-p

--

## Queue events

| ...  | ...       | didReceiveQueueItemIDs        |
| ...  | ...       | didInsertQueueItemsWithIDs    |
| ...  | ...       | didUpdateQueueItemsWithIDs    |
| ...  | ...       | didRemoveQueueItemsWithIDs    |
| ...  | ...       | didReceiveQueueItems          |
| ...  | ...       | didUpdateQueue                |

| ...  | mediaQueueWillChange   | mediaQueueWillChange       |
| ...  | itemsReloaded          | mediaQueueDidReloadItems   |
| ...  | itemsInsertedInRange   | didInsertItemsInRange      |
| ...  | itemsUpdatedAtIndexes  | didUpdateItemsAtIndexes    |
| ...  | itemsRemovedAtIndexes  | didRemoveItemsAtIndexes    |
| ...  | mediaQueueChanged      | mediaQueueDidChange        |

## CHANGELOG

- Added basic Queue support: `loadQueue`, `queueNextItem` & `queuePreviousItem`. Thanks to [loop.tv](https://loop.tv/).
- Implemented some `textTrackStyle` options.
- Added `showCastInstructions` and `showCastDialog`.
- Updated `tns-core-modules` to `6.5.4`.
- Added more types.
- android: Updated `com.google.android.gms:play-services-cast-framework` to `18.1.0`.
- ios: Updated `GoogleCast.framework` to `4.4.7`.
- ios: Fixed incorrect metadata key names.

---

- ios: Updated `GoogleCast.framework` to `4.5.1`.
